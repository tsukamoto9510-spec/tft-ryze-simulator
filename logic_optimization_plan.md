# 実装計画: 最少構成探索への統一と高速化

## 概要
現在の検索ロジックには、「条件によって提示される構成の人数に一貫性がない」という課題があります。
これを解消し、かつサイトの応答速度を向上させるために、**「条件を満たす最小コストの構成（Minimal Subset）」** を徹底して探索するようロジックを改修します。

## 変更の方向性
「指定ユニット数（Lv8など）」はあくまで「許容上限」として扱い、計算自体は「条件を満たす最小人数」が見つかった時点で最適解とみなすように変更します。

### 具体的な変更点
1.  **探索終了条件の厳格化**
    現在の「条件を満たしたら即リターン」のロジックは維持しつつ、探索の優先順位を「人数の少ない順（コストの低い順）」に明確化します。これにより、偶然人数の多い構成が上位に来るのを防ぎます。

2.  **Breadth-First Search (幅優先探索) 的なアプローチまたはコスト順ソート**
    現在の再帰処理（深さ優先探索）は「最初に見つかった解」を採用しがちです。候補ユニットを「コストの安い順」あるいは「キーユニット順」に並べ替えてから探索することで、必然的に「低コスト・少人数」の解が先に見つかるように誘導します。

3.  **スコア計算ロジックの変更**
    現在のスコア計算は「発動シナジー数が多いほど高スコア」となっているため、人数が多い（＝シナジーが多く発動している）構成が上位に来てしまいます。
    これを、「**条件を満たしていること**」を最優先し、その中で「**使用コスト/人数が少ないこと**」を評価するスコアリングに変更します。

    *   **新スコア定義:**
        1. 必須条件をすべて満たしているか？（必須）
        2. 余分なユニットが少ないか？（少ないほど高評価）
        3. コストが安いか？（安いほど高評価）

## 期待される効果
*   **一貫性の向上:** 「アイオニア2」でも「アイオニア2・ヨードル2」でも、常に必要最小限のユニットのみが提示されるようになります。
*   **高速化:** 探索空間が大幅に削減されるため、複雑な条件でも検索が一瞬で終わるようになります。

## 今後のステップ
この計画に基づき、`js/logic.js` の `solve` 関数および `calcScoreOptimized`、ソート処理を修正します。
